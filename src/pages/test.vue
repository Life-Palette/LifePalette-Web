<script setup lang="ts">
const testRef = ref(null)
const imgObj = ref({
  preSrc: `http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711965193523.JPEG?x-oss-process=image/resize,l_50`,
  src: 'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711965193523.JPEG',
  videoSrc:
		'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711965199299.MOV',
})
const tt = {
  src: 'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711984435093.JPEG',
  fileType: 'IMAGE',
  videoSrc:
		'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711983844393.MOV',
  preSrc:
		'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711984435093.JPEG?x-oss-process=image/resize,l_500',
}
onMounted(async () => {
  // await nextTick()
  // const player = LivePhotosKit.Player(testRef.value)
  // console.log('ğŸ§-----player-----', player)
  // player.photoSrc =
  // 	'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711965193523.JPEG'
  // player.videoSrc =
  // 	'http://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1711965199299.MOV'
  // // å½“ç©å®¶è·å¾—åˆšå¤Ÿè§†é¢‘å¸§ï¼Œå¹¶è·å¾—è¶³å¤Ÿè¿…é€Ÿæµç•…æ’­æ”¾
  // player.addEventListener('canplay', (ev) => {
  // 	console.log(ev, 'æˆåŠŸ')
  // })
  // // åŠ è½½ Live Photo çš„ç…§ç‰‡æˆ–è§†é¢‘ç»„ä»¶å¤±è´¥æ—¶
  // player.addEventListener('error', (ev) => {
  // 	console.log('ğŸŒˆ-----ev-----', ev)
  // 	if (typeof ev.detail.errorCode === 'number') {
  // 		switch (ev.detail.errorCode) {
  // 			case LivePhotosKit.Errors.PHOTO_FAILED_TO_LOAD:
  // 				// Do something  å›¾ç‰‡ç»„ä»¶åŠ è½½å¤±è´¥
  // 				break
  // 			case LivePhotosKit.Errors.VIDEO_FAILED_TO_LOAD:
  // 				// Do something  è§†é¢‘ç»„ä»¶åŠ è½½å¤±è´¥
  // 				break
  // 		}
  // 	} else {
  // 		// Extract error.
  // 		console.error(ev.detail.error)
  // 	}
  // })
  // // Liveç…§ç‰‡çš„å›æ”¾å·²ç»å®Œæˆ
  // player.addEventListener('ended', (ev) => {
  // 	console.log(ev, 'å®Œæˆ')
  // })
  // player.play()
})
</script>

<template>
  <div class="box">
    <div class="h-100 w-100">
      <LazyImg
        :pre-src="imgObj.preSrc"
        :src="imgObj.src"
        :video-src="imgObj.videoSrc"
      />
    </div>
    <!-- <div ref="testRef" class="h-100 w-100"></div> -->
  </div>
</template>

<route lang="json">
{
	"meta": {
		"title": "Test",
		"layout": "noCom"
	}
}
</route>
